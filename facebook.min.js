/*!
* facebook.min.js by kougiland.com 
* Copyright 2012 kougiland-System.
  ├── js/
      ├── bootstrap.js
      ├── bootstrap.min.js
    ├── facebook.min.js
usage:-This code is copyrighted to kougiland.
         -This means you may NOT use it for your site's design.
  	 -Twitter Bootstrap-based 
*/

$(function(){
	fbFetch();
	function fbFetch(){
		var page   = "https://graph.facebook.com/"+pageID+"/";
			$.getJSON(page, function(results){
				console.log('results from '+results.name+'with the ID '+results.id+' successfully fetched');
				$("#siteName").append(results.name);
				$("#likesUs").append(results.likes);
				$("#mission").append(results.mission);
				$("#siteDescription").append(results.description);
				$("#founded").append(results.founded);
				$("#siteAbout").append(results.about);
				$("#talkingAbout").append(results.talking_about_count);
				$("#siteOverview").append(results.company_overview);
				$("#siteName").attr("href", results.website);
				$('title').text(results.name + ' | Galleria');
				$('#sliderWrappers').append("<img src='" + results.cover.source + "'/>");
				$('#profile').wrap("<a  target='_blank' href="+results.link+"></a>").css('background-image', 'url(https://graph.facebook.com/'+results.id+'/picture?width=200&height=160)');
				
				//=======================VIDEOS ALBUMS================================================== 
				
				function videos(){
				$.getJSON("https://graph.facebook.com/fql?q=SELECT vid, owner, album_id, length, format, link, src_hq, src, title, description, thumbnail_link, embed_html, updated_time, created_time FROM video WHERE owner=" + results.id, function(videos) {
						$.each(videos.data, function(entryIndex, singleVideo) {
						console.log(singleVideo.vid+' HD VIDEO '+singleVideo.src_hq);
							var title = singleVideo.title,
								description = singleVideo.description,
								thumb = singleVideo.thumbnail_link,
								embedPlayer = singleVideo.embed_html;

							$("#d-e-f").append("<ul class=albumsWrapper>"+
													"<li class='singleAlbumDescription transitionAll300ms-ease-in-out'><b>" +title+"</b><p>"+description+ "</p></li>"+
													"<li class=singleAlbumImages>"+embedPlayer+"</li>"+
											   "</ul>");        
						});
					});
				}
				
				function events(){
				$.getJSON("https://graph.facebook.com/fql?q=SELECT eid FROM event WHERE eid IN ( SELECT eid FROM event_member WHERE uid = 22092443056 ) AND end_time > now() ORDER BY end_time asc", function(events) {
						$.each(videos.data, function(entryIndex, singleEvent) {
							console.log(singleEvent); 
						});
					});
				}
				
				//=======================VIDEOS OPTIONS================================================== 
				videos();
				events();
			});
			
			//========================PHOTOS ALBUMS==================================================
			$.getJSON(page+"albums",function(json){
				console.log('results from albums success'); 
				$.each(json.data,function(i,fbalbum){
					var albumsCoverLink = "https://graph.facebook.com/"+fbalbum.id+"/picture",
					   albumsPhotosLink = "https://graph.facebook.com/"+fbalbum.id+"/photos",
				  allAlbumImagesWrapper = "<figure id=album-"+fbalbum.id+" class=allAlbumImagesWrapper><figcaption>description:" + fbalbum.description + "</figcaption></figure>",
							 albumLikes	= "<div>likes:" + fbalbum.likes + "</div>",
					  albumCoverPhotoID	= "<div>cover Id:" + fbalbum.cover_photo + "</div>",
					  albumPictureCount	= "<div class=picturesIn>" + fbalbum.count + " Pictures </div>",
					  albumCreatedTime	= "<div class=created_time>Date: " + fbalbum.created_time + "</div>",
						 albumLocation	= "<div>location:" + fbalbum.location + "</div>",
							   albumID	= "<div>id:" + fbalbum.id + "</div>",
							 albumName	= "<div class=album-name>" + fbalbum.name + "</div>",
							 albumLink	= "<a class=albumLink href=" + fbalbum.link + " target='_blank'>link &origof;</a>";
					$("#a-b-c").append("<ul class=albumsWrapper><li class=singleAlbumDescription>"+albumLink+albumName+albumLikes+albumPictureCount+albumCreatedTime+albumLocation+"</li><li class=singleAlbumImages>"+allAlbumImagesWrapper+"</li></ul>");
					//$('img').attr('src',function(i,e){return e.replace("o.jpg","s.jpg");});//o:big n:large s:small
			
					console.log('results from album '+fbalbum.name+' successfully fetched');
					$.getJSON(albumsPhotosLink,function(jsonPictures){
						$.each(jsonPictures.data,function(i,albumsPhoto){
							if(i<1){
								$("#album-"+fbalbum.id+"").append("<img src='" + albumsPhoto.images[0].source + "'/>");
							}
							//console.log(albumsPhoto.source); // large Picture
							//console.log(albumsPhoto.picture);// small Picture
							//console.log(albumsPhoto.images[0].source);//big Picture
						});
					});
				});
				var dontShow = $('body').find(".album-name").text();
				if (dontShow === "Cover Photos" || dontShow === "Timeline Photos" || dontShow === "Profile Pictures"){
					//do something
				}
				$('.albumsWrapper').click(function () {
					$("#body3D").addClass("body3D");
					$("#sliderWrapper").empty();
					var newAblbumID = $(this).find("figure").attr("id"),
						newAblbumIDFinal=newAblbumID.replace('album-', ''),
						albumsPhotosLink = "https://graph.facebook.com/"+newAblbumIDFinal+"/photos";
					$.getJSON(albumsPhotosLink,function(jsonPictures){
						$.each(jsonPictures.data,function(i,albumsPhoto){
							$("#sliderWrapper").append("<li><figure><img src='" + albumsPhoto.images[0].source + "'/><figcaption><p>"+albumsPhoto.name+"</p><p><span>"+albumsPhoto.created_time+"</span><a href="+albumsPhoto.link+" target='_blank'>Link</a></p></figcaption></figure></li>");
						});
						$("#sliderWrapper li:first-child").addClass('active');
					});					
					$('#sliderWrapper').delay(600).animate({'top' : '4%', 'opacity':'1'},300,function(){
						$(".sliderItems").fadeIn(300);
					});
				});	
			});
			//removing empty undefined elements from the dom
		$('#body3D').children().filter(function() {
			return $.trim($(this).text()) === 'undefined' && $(this).children().length == 0
		}).remove();
	};

});
